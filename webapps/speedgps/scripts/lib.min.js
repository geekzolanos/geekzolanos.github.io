"use strict";window.compat={name:"Compat",catalog:[],idxCatalog:0,checkBrowser:function(){var e;return!!navigator.sayswho&&(e=(e=navigator.sayswho()).split(" "),parseInt(e[1]),e[0],!0)},setPolyfill:function(e,t){if("string"!=typeof e)throw new TypeError("filename no es una cadena.");var a=document.location.pathname,n=a.slice(0,a.lastIndexOf("/")+1),o=document.createElement("script");o.src=n+"scripts/thirdparty/polyfills/"+e,o.async=!1,document.head.appendChild(o),"function"==typeof t&&("addEventListener"in o?o.addEventListener("load",t):o.onload=o.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||t()})},sendSuccess:function(){var e=new CustomEvent("compatpass");window.dispatchEvent(e)},evaluate:function(e){this.checkBrowser()&&Modernizr?this.checkModules(e):e()},checkModules:function(t){var a=this,n=this,o=this.idxCatalog;o<this.catalog.length?Modernizr.on(this.catalog[o].module,function(e){e?(n.idxCatalog++,a.checkModules(t)):a.catalog[o].polyfill?a.setPolyfill(a.catalog[o].polyfill,function(){n.idxCatalog++,n.checkModules(t)}):t()}):this.sendSuccess()},register:function(e,t){if("string"!=typeof e)throw new TypeError("name no es una cadena.");this.catalog.push({module:e,polyfill:t})}},navigator.sayswho=function(){var e,t,a=navigator.userAgent;return t=a.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],/trident/i.test(t[1])?"IE "+((e=/\brv[ :]+(\d+)/g.exec(a)||[])[1]||""):"Chrome"===t[1]&&null!==(e=a.match(/\b(OPR|Edge)\/(\d+)/))?e.slice(1).join(" ").replace("OPR","Opera"):(t=t[2]?[t[1],t[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(e=a.match(/version\/(\d+)/i))&&t.splice(1,1,e[1]),t.join(" "))};
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}window.utils={name:"Utils",setTransition:function(t,e){if(!("parentNode"in t))throw new TypeError("domNode no es un nodo DOM valido");e?t.setAttribute("data-transition",e):t.removeAttribute("data-transition")},getRootPath:function(){var t=document.location.pathname,e=t.lastIndexOf("/")+1;return t.slice(0,e)},getTouchEvents:function(){var t="ontouchstart"in document.createElement("div");return{isTouch:t,start:t?"touchstart":"mousedown",move:t?"touchmove":"mousemove",end:t?"touchend":"mouseup"}},setSize:function(t,e){if(!("parentNode"in t))throw new TypeError("domNode no es un nodo DOM valido");if(e.constructor!=Size)throw new TypeError("size no es una instancia de Size");t.style.width=e.width,t.style.height=e.height},setAbsolutePos:function(t,e){var n,o,i,r,s,a,l,u,f,c,p={};if(!("parentNode"in t))throw new TypeError("domNode no es un nodo DOM valido");if(e.constructor!=Position)throw new TypeError("position no es una instancia de Position");if(n=t.style.transform){if(s=n.indexOf("translateX"),l=n.indexOf("translateY"),-1!=s&&(a=n.indexOf(")",s),i=n.slice(s+11,a),n=n.replace(n.slice(s,a+1),"")),-1!=l&&(u=n.indexOf(")",l),r=n.slice(l+11,u),n=n.replace(n.slice(l,u+1),"")),!i&&!r&&-1!=(f=n.indexOf("translate"))){c=n.indexOf(")",f),o=n.slice(f+10,c),n=n.replace(n.slice(f,c+1),"");for(var d=(o=o.split(",")).length-1;0<=d;d--)o[d].trim()}o?(p.x=o[0],o[1]&&(p.y=o[1])):(i&&(p.x=i),r&&(p.y=r)),n.trim()}e.translateX&&(p.x=e.translateX),e.translateY&&(p.y=e.translateY),p.x||(p.x=0),p.y||(p.y=0),n?t.style.transform=n+" translate("+p.x+","+p.y+")":(t.style.transform="translate("+p.x+","+p.y+")",e.top&&(t.style.top=e.top),e.left&&(t.style.left=e.left),e.right&&(t.style.right=e.right),e.bottom&&(t.style.bottom=e.bottom))},opacityTransition:function(e,n,t){var o=350;if(!("parentNode"in e))throw new TypeError("domNode no es un nodo DOM valido");return"number"==typeof t&&(o=t),e.style.opacity=0,new Promise(function(t){setTimeout(function(){e.innerHTML=n,e.style.opacity=1,t()},o)})},isValidUnitVal:function(t){var e=["px","rem","%"],n=0;if("string"!=typeof t)return!1;for(var o=0;o<e.length;o++)if(-1!=(n=t.indexOf(e[o])))return!isNaN(parseInt(t.substring(0,n)));return!1},toggleCheckbox:function(){var t;return"querySelector"in this&&(t=this.querySelector("input[type='checkbox']"))&&(t.checked=!t.checked),!1},fetch:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(t){return app.isBrowser?fetch(t):fetchLocal(t)})},window.Size=function(t,e){var n="auto";this.width=utils.isValidUnitVal(t)?t:n,this.height=utils.isValidUnitVal(e)?e:n},window.Position=function(t){if("object"!=_typeof(t))throw new TypeError("obj no es un objeto.");t.top&&(this.top=utils.isValidUnitVal(t.top)?t.top:"unset"),t.left&&(this.left=utils.isValidUnitVal(t.left)?t.left:"unset"),t.right&&(this.right=utils.isValidUnitVal(t.right)?t.right:"unset"),t.bottom&&(this.bottom=utils.isValidUnitVal(t.bottom)?t.bottom:"unset"),t.translateX&&(this.translateX=utils.isValidUnitVal(t.translateX)?t.translateX:null),t.translateY&&(this.translateY=utils.isValidUnitVal(t.translateY)?t.translateY:null)},window.fetchLocal=function(o){return new Promise(function(t,e){var n=new XMLHttpRequest;n.onload=function(){t(new Response(n.responseText,{status:n.status}))},n.onerror=function(){e(new TypeError("Local request failed"))},n.open("GET",o),n.send(null)})},window.Positions={TOP:new Position({top:"0px",bottom:"unset",translateY:null}),LEFT:new Position({left:"0px",right:"unset",translateX:null}),RIGHT:new Position({left:"unset",right:"0px",translateX:null}),BOTTOM:new Position({top:"unset",bottom:"0px",translateY:null}),CENTER:new Position({top:"50%",left:"50%",right:"unset",bottom:"unset",translateX:"-50%",translateY:"-50%"}),ZERO:new Position({top:"0px",left:"0px",right:"unset",bottom:"unset",translateX:"0px",translateY:"0px"})};
"use strict";function Activity(e,i){var t;if(!e)throw new TypeError("La categoria no esta definida.");if(!i)throw new TypeError("a actividad no esta definida.");try{if(!(t=am.catalog.parsedTree[e].activities[i]))throw new Error("NO_ACT")}catch(t){throw new ReferenceError('La actividad "'+e+"/"+i+'" no existe.')}this.name=i,this.title=t.title,this.path=app.rootPath+"activities/"+e+"/",this.filename=i+".html"}function Slot(t){t=am.slot.checkOptions(t),this.id=am.slot.assignID(t.id),this.locked=t.locked,this.size=t.size,this.position=t.position,this.lazyLoaded=!1,this.activity=null,this.updateConfig=function(){var t=this,e=t.domNode;e.setAttribute("data-id",t.id),t.locked?e.setAttribute("am-lock","true"):e.removeAttribute("am-lock"),t.size&&utils.setSize(e,t.size),t.position&&utils.setAbsolutePos(e,t.position)},this.loadActivity=function(i,o){var n=this,a=this.domNode;if(o||(o={}),!(i instanceof Activity))throw new TypeError("El objeto no es una actividad.");return new Promise(function(t,e){n.clear(),am.lazyLoader.load(i,n,o.args).then(function(){a.setAttribute("am-busy",!0),o.animation?utils.setTransition(a,o.animation):utils.setTransition(a),t()})})},this.clear=function(t){var e=this.domNode,i=this;return t||(t={}),!!this.lazyLoaded&&(t.animation?utils.setTransition(e,t.animation):utils.setTransition(e),setTimeout(function(){am.lazyLoader.unload(i),e.removeAttribute("am-busy")},500))},this.remove=function(){var t=this.domNode;this.clear(),t.parentNode.removeChild(t)},this.hide=function(t){var e=this.domNode;t&&(e.style.visibility="hidden"),e.style.opacity=0},this.show=function(){var t=this.domNode;"hidden"==t.style.visibility&&(t.style.visibility=null),t.style.opacity=null}}window.AM_TLOCK=!1;var am={constructors:{},createSlots:function(t){if(isNaN(t)||t<=0)throw new TypeError("El valor no es un numero.");for(var e=0;e<t;e++)am.slot.create({})},startActivity:function(a,r){if(!(a instanceof Activity))throw new TypeError("El objeto no es una Actividad.");if(!0!==AM_TLOCK){AM_TLOCK=!0;var s=this;return r||(r={}),new Promise(function(t,e){var i=document.querySelector("div.slot[am-busy]:not([am-lock])"),o=document.querySelector("div.slot:not([am-busy]):not([am-lock])");i&&(i=s.slot.getByNode(i)),o&&(o=s.slot.getByNode(o)),o||(AM_TLOCK=!1,e("No hay slots disponibles para dibujar la actividad."));var n=o.loadActivity(a,{animation:r.animation?r.animation[0]:null,args:r.arguments?r.arguments:null});i&&n.then(function(){return i.clear({animation:r.animation?r.animation[1]:null}),AM_TLOCK=!1,t()}),AM_TLOCK=!1,t()})}}};am.catalog={parsedTree:{},populate:function(){var o=this;return new Promise(function(e,t){var i=app.rootPath+"activities/activities.json";utils.fetch(i).then(function(t){return t.json()},t).then(function(t){o.parsedTree=t,o.parsedTree.isParsed=!0,e()},t)})},get:function(t,e){if(!t)throw new TypeError("La categoria no esta definida.");if(!e)throw new TypeError("a actividad no esta definida.");if(!this.parsedTree.isParsed)throw new Error("No se han leido los datos del catalogo.");return new Activity(t,e)}},am.events={catalog:{},suscribe:function(t,e){if(!e)throw new TypeError("Event no esta definido.");if(this.catalog[e]||(this.catalog[e]=[]),!(t instanceof Window)){if(!t.activity)throw new ReferenceError("El Slot no esta asociado a ninguna actividad.");t.activity.events||(t.activity.events=[]),t.activity.events.push(e)}this.catalog[e].includes(t)||this.catalog[e].push(t)},dispatchAll:function(e){if(!(e instanceof Event||e instanceof CustomEvent))throw new TypeError("El objeto no es un Evento.");this.catalog[e.type]&&this.makeHygiene(e.type),this.catalog[e.type].forEach(function(t){t==window?window.dispatchEvent(e):t.domNode.dispatchEvent(e)})},makeHygiene:function(i){if(!i)throw new TypeError("Event no esta definido.");var o=this.catalog[i];o.forEach(function(t,e){t instanceof Window||(t.activity&&t.activity.events&&t.activity.events.includes(i)||o.splice(e,1))})}},am.lazyLoader={load:function(i,o,n){var a,r=this,s=o.domNode;if(!(i instanceof Activity))throw new TypeError("El objeto no es una Actividad");if(!("innerHTML"in s))throw new TypeError("El nodo DOM no es correcto.");return new Promise(function(e,t){!0===o.lazyLoaded&&t(),a=i.path+i.filename,utils.fetch(a).then(function(t){return t.text()},t).then(function(t){s.innerHTML=t,o.activity=i,r.loadResources(o).then(function(){r.lazyRunner(o,n),e()})})})},loadResources:function(t){return Promise.all([this.loadJS(t),this.loadCSS(t)])},waitForScript:function(e){if(!(e instanceof HTMLScriptElement))throw new TypeError("El objeto no representa un Script");return new Promise(function(t){e.addEventListener("load",t)})},loadJS:function(s){var c=s.domNode;if(!("innerHTML"in c))throw new TypeError("El nodo DOM no es correcto.");var d=this;return new Promise(function(t){for(var e=[],i=s.activity.path+"scripts/",o=c.querySelectorAll("meta[name='activityScript']"),n=o.length-1;0<=n;n--){var a=o[n],r=document.createElement("script");r.setAttribute("slot-id",s.id),r.src=i+a.content,r.async=!1,e.push(d.waitForScript(r)),document.head.appendChild(r),a.parentNode.removeChild(a)}Promise.all(e).then(t)})},loadCSS:function(r){var s=r.domNode;if(!("innerHTML"in s))throw new TypeError("El nodo DOM no es correcto.");return new Promise(function(t){for(var e=r.activity.path+"style/",i=s.querySelectorAll("meta[name='activityStyle']"),o=i.length-1;0<=o;o--){var n=i[o],a=document.createElement("link");a.setAttribute("slot-id",r.id),a.rel="stylesheet",a.type="text/css",a.href=e+n.content,document.head.appendChild(a),n.parentNode.removeChild(n)}t()})},lazyRunner:function(t,e){var i=t.domNode;if(!("innerHTML"in i))throw new TypeError("El nodo DOM no es correcto.");var o=t.activity,n=am.constructors[o.name];i.setAttribute("data-activity",o.name),"function"==typeof n&&(o.js=new n,"load"in o.js&&(e||(e=[]),e.splice(0,0,t),o.js.load.apply(o.js,e))),t.lazyLoaded=!0},unload:function(t,e){var i=t.domNode;if(!("innerHTML"in i))throw new TypeError("El nodo DOM no es correcto.");var o,n,a=t.activity;return t.lazyLoaded&&("unload"in a.js&&(Array.isArray(e)||(e=[]),e.splice(0,1,t),a.js.unload.apply(a.js,e)),t.activity=null,t.lazyLoaded=!1,i.removeAttribute("data-activity"),i.innerHTML="",o=document.head.querySelectorAll('script[slot-id="'+t.id+'"]'),n=document.head.querySelectorAll('link[slot-id="'+t.id+'"]'),Array.prototype.forEach.call(o,function(t){document.head.removeChild(t)}),Array.prototype.forEach.call(n,function(t){document.head.removeChild(t)})),!1}},am.slot={lastID:-1,catalog:[],create:function(t){var e=new Slot(t),i=this.setNode(e);return document.body.appendChild(i),e.updateConfig(),e},getByNode:function(t){return this.catalog[t.dataset.id]},setNode:function(t){if(!(t instanceof Slot))throw new TypeError('El objeto Data no es "Slot"');var e=document.createElement("div");return e.classList.add("slot"),e.setAttribute("data-id",t.id),t.domNode=e,this.catalog[t.id]=t,e},checkOptions:function(t){return"boolean"!=typeof t.locked&&(t.locked=!1),t.size&&(t.size instanceof Size||(t.size=null)),t.position&&(t.position instanceof Position||(t.position=null)),t},assignID:function(t){var e=null;return t&&!isNaN(t)&&(e=document.querySelector('div.slot[data-id="'+t+'"]')),e?t:++this.lastID}};
"use strict";window.indexedDB||(window.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB),window.IDBHelper=function(){var s=null;this.createStructure=null,this.connect=function(o,t){var i=this;if("string"!=typeof o)throw new TypeError("name no es una cadena.");return"number"!=typeof t&&(t=1),new Promise(function(n,e){var r=window.indexedDB.open(o,t);r.onerror=e,r.onsuccess=function(e){s=e.target.result,n()},"function"==typeof i.createStructure&&(r.onupgradeneeded=i.createStructure)})};var c=function(e,n){if("string"!=typeof e)throw new TypeError("osName no es una cadena.");var r=n?"readwrite":"readonly";return!!s&&s.transaction([e],r).objectStore(e)},a=function(t,i,s){var a=[];if("string"!=typeof t)throw new TypeError("osName no es una cadena.");return new Promise(function(r,e){var n=c(t);i&&(n=n.index(i));var o=s?n.openCursor(s[0],s[1]):n.openCursor();o.onsuccess=function(e){var n=e.target.result;n?(a.push(n.value),n.continue()):r(a)},o.onerror=e})},u=function(r,o,t){if("string"!=typeof r)throw new TypeError("osName no es una cadena.");if(!o)throw new ReferenceError("key no esta definido.");return new Promise(function(e){var n=c(r,!0);(t?n.index(t).delete(o):n.delete(o)).onsuccess=e})};this.getObjectStore=c,this.addObject=function(o,t){if("string"!=typeof o)throw new TypeError("osName no es una cadena.");if(!t)throw new ReferenceError("obj no esta definido.");return new Promise(function(e,n){var r=c(o,!0).add(t);r.onsuccess=e,r.onerror=n})},this.putObject=function(o,t){if("string"!=typeof o)throw new TypeError("osName no es una cadena.");if(!t)throw new ReferenceError("obj no esta definido.");return new Promise(function(e,n){var r=c(o,!0).put(t);r.onsuccess=e,r.onerror=n})},this.getObject=function(t,i,s){if("string"!=typeof t)throw new TypeError("osName no es una cadena.");if(i)throw new ReferenceError("key no esta definido.");return new Promise(function(e,n){var r=c(t),o=s?r.index(s).get(i):r.get(i);o.onsuccess=e,o.onerror=n})},this.getObjects=a,this.removeObject=u,this.removeObjects=function(t,i,s){if("string"!=typeof t)throw new TypeError("osName no es una cadena.");return new Promise(function(n,r){var e=a(t,i,s),o=[];e.then(function(e){e.forEach(function(e){o.push(u(t,e.keyPath))}),Promise.all(o).then(n,r)})})},this.clearObjectStore=function(e){if("string"!=typeof e)throw new TypeError("osName no es una cadena.");var n=c(e,!0);return new Promise(function(e){n.clear().onsuccess=e})}};